# Electron RTLS Equipment Tracking Application - Architecture Plan

## Project Overview

This document outlines the architecture for an Electron application that processes Real-Time Location System (RTLS) data to track and optimize equipment usage in a healthcare setting. The application will:

1. Import and analyze RTLS data from CSV files
2. Visualize equipment movement patterns with interactive heat maps
3. Track equipment usage and location history
4. Generate optimization recommendations to reduce staff walking distance
5. Monitor equipment utilization to support purchase decisions
6. Track maintenance needs based on usage patterns

The app will leverage existing UI components and will use room location data from `floor_plan_progress.json` and distance data from `graph_data.json`.

## Architecture Diagram

```
Main Process (Electron) <--> Renderer Process (React)
       |                           |
       v                           v
File System Access         React Components
       |                           |
       v                           v
    NeDB Database <-----> Data Processing Services
                                   |
                                   v
                          Optimization Algorithms
```

## Component Structure

```
App Entry
  |
  +--> Main Window
  |      |
  |      +--> Navigation
  |             |
  |             +--> ImportData View (CSV import, processing)
  |             |
  |             +--> Dashboard View (Usage stats, recommendations)
  |             |
  |             +--> HeatMap View (Floor plan, movement visualization)
  |             |
  |             +--> DataTable View (Detailed data grid)
  |
  +--> Services
         |
         +--> Database Service (NeDB)
         |
         +--> Data Processing Service
         |      |
         |      +--> CSV Parser
         |      |
         |      +--> Data Analyzer
         |      |
         |      +--> Recommendation Generator
         |
         +--> Optimization Service
                |
                +--> Walking Distance Optimizer
                |
                +--> Utilization Analyzer
                |
                +--> Maintenance Predictor
```

## Data Model (NeDB)

### 1. Devices Collection

- `_id`: Unique identifier (auto-generated by NeDB)
- `deviceId`: Original device identifier from CSV (e.g., "Ventilator-001")
- `deviceType`: Extracted from deviceId (e.g., "Ventilator")
- `status`: Current status (e.g., "In Use", "Available")
- `lastMaintenance`: Timestamp of last maintenance
- `totalUsageHours`: Accumulated usage hours
- `currentLocation`: Current room/location ID
- `metadata`: Object for additional device properties

### 2. Locations Collection

- `_id`: Unique identifier (auto-generated by NeDB)
- `locationId`: Room ID from graph_data (e.g., "K2716")
- `name`: Human-readable name (if available)
- `coordinates`: [x, y] from floor_plan_progress
- `metadata`: Object for additional location properties

### 3. Movements Collection

- `_id`: Unique identifier (auto-generated by NeDB)
- `deviceId`: Reference to device
- `fromLocation`: Source location ID
- `toLocation`: Destination location ID
- `timeIn`: Timestamp when entered location
- `timeOut`: Timestamp when left location
- `status`: Status during this period
- `distanceTraveled`: Calculated from graph_data

### 4. Recommendations Collection

- `_id`: Unique identifier (auto-generated by NeDB)
- `type`: Type of recommendation (e.g., "placement", "purchase", "maintenance")
- `title`: Short description
- `description`: Detailed explanation
- `savings`: Estimated savings (time or cost)
- `implemented`: Boolean flag
- `createdAt`: Timestamp

## Detailed Optimization Algorithms

### 1. Staff Walking Distance Optimization

We will implement a graph-based approach using Dijkstra's algorithm to find optimal equipment placement based on usage frequency and walking distance.

#### Algorithm Details:

1. **Graph Construction**:

   - Nodes represent rooms/locations from the graph_data
   - Edges represent paths between rooms with weights based on distances
   - The graph will be constructed from the graph_data.json file

2. **Usage Pattern Analysis**:

   - Analyze historical movement data to identify:
     - Frequency of equipment requests by location
     - Common movement patterns between locations
     - Time spent at each location

3. **Optimization Process**:

   - For each equipment type:
     - Calculate current total walking distance based on historical movements
     - For each potential "home location" (storage room):
       - Use Dijkstra's algorithm to calculate shortest paths to all request locations
       - Weight paths by request frequency
       - Calculate total weighted walking distance
     - Identify the home location that minimizes total weighted walking distance

4. **Recommendation Generation**:

   - Compare optimized placement with current placement
   - Calculate potential time/distance savings
   - Generate specific recommendations for equipment relocation
   - Prioritize recommendations based on potential savings

5. **Implementation Approach**:
   - Use a priority queue for efficient Dijkstra's algorithm implementation
   - Cache shortest path calculations for performance
   - Implement incremental updates as new movement data is collected
   - Provide visualization of current vs. optimized equipment placement

### 2. Equipment Utilization Optimization

We will implement a time-series analysis that identifies peak usage periods and calculates utilization rates to determine if additional equipment purchases are justified.

#### Algorithm Details:

1. **Data Preparation**:

   - Aggregate equipment usage data by type, time period, and location
   - Calculate utilization rates (time in use / total available time)
   - Identify peak usage periods and patterns

2. **Time-Series Analysis**:

   - Apply time-series decomposition to separate:
     - Trend component (long-term increase/decrease)
     - Seasonal component (regular patterns by hour, day, week)
     - Residual component (irregular fluctuations)
   - Identify peak usage times and durations
   - Calculate utilization rates during different time periods

3. **Demand Forecasting**:

   - Use historical patterns to forecast future demand
   - Identify periods where demand exceeds or will exceed capacity
   - Calculate the probability of equipment shortages

4. **Purchase Justification Analysis**:

   - For equipment types with high utilization:
     - Calculate the impact of adding additional units
     - Estimate the reduction in wait times or delays
     - Perform cost-benefit analysis based on time savings
   - Generate purchase recommendations with supporting data

5. **Implementation Approach**:
   - Use moving averages and exponential smoothing for trend analysis
   - Implement seasonal decomposition for pattern recognition
   - Provide visualizations of utilization patterns and forecasts
   - Allow for "what-if" scenarios to test different purchase options

### 3. Maintenance Scheduling Optimization

We will implement a predictive maintenance model that uses usage hours, movement frequency, and historical maintenance data to predict optimal maintenance timing.

#### Algorithm Details:

1. **Usage Metrics Collection**:

   - Track total usage hours for each device
   - Monitor movement frequency and distances traveled
   - Record environmental factors if available (temperature, humidity)
   - Log maintenance history and issues

2. **Predictive Model Development**:

   - Develop a statistical model that correlates:
     - Usage intensity (hours, movements)
     - Time since last maintenance
     - Historical failure patterns
   - Calculate failure probability over time for each device

3. **Maintenance Timing Optimization**:

   - Balance preventive maintenance costs against failure costs
   - Consider operational impact of maintenance timing
   - Group maintenance activities for similar equipment when possible
   - Adjust maintenance intervals based on actual usage patterns

4. **Recommendation Generation**:

   - Generate proactive maintenance alerts before predicted failures
   - Prioritize maintenance activities based on criticality and risk
   - Provide maintenance schedules optimized for minimal operational impact
   - Track maintenance compliance and effectiveness

5. **Implementation Approach**:
   - Use regression models for failure prediction
   - Implement Bayesian updating as new data becomes available
   - Provide visualizations of maintenance schedules and risk levels
   - Allow manual adjustments to maintenance schedules

## Implementation Plan

### 1. Project Setup (Week 1)

- Create Electron application structure
- Set up React with Material-UI
- Configure NeDB database
- Set up development environment

### 2. Core Services Implementation (Week 2)

- Implement database service with NeDB
- Create data processing service
- Implement CSV import functionality
- Set up IPC communication between main and renderer processes

### 3. UI Integration (Week 3)

- Integrate existing React components
- Create main application layout and navigation
- Implement context providers for state management
- Connect UI components to backend services

### 4. Optimization Algorithms Implementation (Week 4)

- Implement graph-based walking distance optimization
- Develop time-series analysis for utilization optimization
- Create predictive maintenance model
- Connect algorithms to recommendation system

### 5. Visualization Enhancement (Week 5)

- Implement interactive floor plan visualization
- Create heatmap visualization for equipment usage
- Develop movement pattern visualization
- Enhance dashboard with optimization insights

### 6. Testing and Refinement (Week 6)

- Perform unit and integration testing
- Optimize performance for large datasets
- Refine user interface based on feedback
- Fix bugs and address edge cases

## Technical Stack

### Frontend

- React for UI components
- Material-UI for styling
- D3.js for visualizations
- Context API for state management

### Backend

- Electron for desktop application
- Node.js for main process
- NeDB for data storage
- IPC for communication between processes

### Build Tools

- Webpack for bundling
- Babel for transpilation
- Electron-builder for packaging

## Folder Structure

```
electron-rtls-app/
├── package.json
├── electron/
│   ├── main.js                 # Main process entry
│   ├── preload.js              # Preload script for IPC
│   └── database.js             # Database initialization
├── src/
│   ├── index.js                # Renderer process entry
│   ├── App.js                  # Main React component
│   ├── components/             # Reusable UI components
│   │   ├── DashboardCard.js
│   │   └── RecommendationCard.js
│   ├── views/                  # Application views
│   │   ├── Dashboard.js
│   │   ├── DataTable.js
│   │   ├── HeatMap.js
│   │   └── ImportData.js
│   ├── services/               # Backend services
│   │   ├── DatabaseService.js
│   │   ├── DataProcessingService.js
│   │   └── OptimizationService.js
│   ├── context/                # React context providers
│   │   ├── DataContext.js
│   │   └── ThemeContext.js
│   ├── utils/                  # Utility functions
│   │   ├── helpers.js
│   │   └── constants.js
│   ├── algorithms/             # Optimization algorithms
│   │   ├── PathOptimizer.js
│   │   ├── UtilizationAnalyzer.js
│   │   └── MaintenancePredictor.js
│   └── assets/                 # Static assets
│       ├── floor_plan_progress.json
│       └── graph_data.json
├── public/                     # Public assets
│   └── index.html
└── config/                     # Build configuration
    ├── webpack.config.js
    └── electron-builder.yml
```

## Conclusion

This architecture plan provides a comprehensive blueprint for developing an Electron-based RTLS Equipment Tracking Application. The application will leverage NeDB for data storage and implement sophisticated optimization algorithms to improve equipment management in healthcare settings.

The plan prioritizes:

1. A graph-based approach using Dijkstra's algorithm for staff walking distance optimization
2. Time-series analysis for equipment utilization optimization
3. Predictive maintenance modeling for maintenance scheduling

By implementing these features, the application will help healthcare facilities optimize equipment placement, make informed purchase decisions, and proactively manage maintenance needs, ultimately improving operational efficiency and patient care.
